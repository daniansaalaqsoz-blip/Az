ZWNobyAiWzFdIE9OICAobG9jayBtYXggTUh6KSIKZWNobyAiWzJdIE9GRiAoYmFsaWsgbm9ybWFsIGF1dG8gc2NhbGUpIgplY2hvICJbYl0gQmFjayIKZWNobwpyZWFkIC1wICJQaWxpaDogIiBjCgpjYXNlICRjIGluCjEpCiAgICBlY2hvICJbK10gTG9jayBNQVggcGVyZm9ybWFuY2UuLi4iCgogICAgTUFYPSQoY2F0IC9zeXMvZGV2aWNlcy9zeXN0ZW0vY3B1L2NwdTAvY3B1ZnJlcS9jcHVpbmZvX21heF9mcmVxKQoKICAgIHN1IC1jICJmb3IgZiBpbiAvc3lzL2RldmljZXMvc3lzdGVtL2NwdS9jcHUqL2NwdWZyZXEvc2NhbGluZ19nb3Zlcm5vcjsgZG8gZWNobyBwZXJmb3JtYW5jZSA+IFwkZjsgZG9uZSIKICAgIHN1IC1jICJmb3IgZiBpbiAvc3lzL2RldmljZXMvc3lzdGVtL2NwdS9jcHUqL2NwdWZyZXEvc2NhbGluZ19taW5fZnJlcTsgZG8gZWNobyAkTUFYID4gXCRmOyBkb25lIgogICAgc3UgLWMgImZvciBmIGluIC9zeXMvZGV2aWNlcy9zeXN0ZW0vY3B1L2NwdSovY3B1ZnJlcS9zY2FsaW5nX21heF9mcmVxOyBkbyBlY2hvICRNQVggPiBcJGY7IGRvbmUiCgogICAgZWNobyAi4pyFIExvY2tlZCBrZSBtYXggc3BlZWQiCiAgICBwYXVzZQogICAgbWFpbl9tZW51CiAgICA7OwoKMikKICAgIGVjaG8gIlsrXSBCYWxpa2luIE5PUk1BTCAoYXV0byBzY2FsaW5nKS4uLiIKCiAgICBNSU49JChjYXQgL3N5cy9kZXZpY2VzL3N5c3RlbS9jcHUvY3B1MC9jcHVmcmVxL2NwdWluZm9fbWluX2ZyZXEpCiAgICBNQVg9JChjYXQgL3N5cy9kZXZpY2VzL3N5c3RlbS9jcHUvY3B1MC9jcHVmcmVxL2NwdWluZm9fbWF4X2ZyZXEpCgogICAgc3UgLWMgImZvciBmIGluIC9zeXMvZGV2aWNlcy9zeXN0ZW0vY3B1L2NwdSovY3B1ZnJlcS9zY2FsaW5nX2dvdmVybm9yOyBkbyBlY2hvIHNjaGVkdXRpbCA+IFwkZjsgZG9uZSIKICAgIHN1IC1jICJmb3IgZiBpbiAvc3lzL2RldmljZXMvc3lzdGVtL2NwdS9jcHUqL2NwdWZyZXEvc2NhbGluZ19taW5fZnJlcTsgZG8gZWNobyAkTUlOID4gXCRmOyBkb25lIgogICAgc3UgLWMgImZvciBmIGluIC9zeXMvZGV2aWNlcy9zeXN0ZW0vY3B1L2NwdSovY3B1ZnJlcS9zY2FsaW5nX21heF9mcmVxOyBkbyBlY2hvICRNQVggPiBcJGY7IGRvbmUiCgogICAgZWNobyAi4pyFIEJhbGlrIG5vcm1hbCAoYmlzYSB0dXJ1biBrZSBsb3cgTUh6IGxhZ2kpIgogICAgcGF1c2UKICAgIG1haW5fbWVudQogICAgOzsKCmIpIG1haW5fbWVudSA7OwoqKSBjcHVfYm9vc3RfbW9kZSA7Owplc2FjCn0KCiMgPT09PT09PT09PT09PT09PT0gQ09QWSBTQ1JJUFQgTU9ERSA9PT09PT09PT09PT09PT09PQpjb3B5X21vZGUoKSB7CgpOQU1FUz0oCiJDaGxvZSIKIkx5bnh4IgoiWWxueHh4IgopCgpVUkxTPSgKImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYW5pYW5zYWFsYXFzb3otYmxpcC9Bei9yZWZzL2hlYWRzL21haW4vQ2hsb2UlMjB4LnR4dCIKImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYW5pYW5zYWFsYXFzb3otYmxpcC9Bei9yZWZzL2hlYWRzL21haW4vTHlueHgudHh0IgoiaHR0cHM6Ly9leGFtcGxlLmNvbS95bG54eHgudHh0IgopCgpzaG93X2ZpbGUoKSB7CiAgICB1cmw9IiQxIgogICAgdG1wPSIkSE9NRS8udGVtcF9zaG93LnR4dCIKCiAgICBlY2hvCiAgICBlY2hvICJbK10gRG93bmxvYWRpbmcuLi4iCiAgICBjdXJsIC1MIC1zICIkdXJsIiAtbyAiJHRtcCIKCiAgICBjbGVhcgogICAgZWNobyAiPT09PT09PT09PSBJU0kgRklMRSA9PT09PT09PT09IgogICAgY2F0ICIkdG1wIgogICAgZWNobyAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iCiAgICBlY2hvCiAgICBybSAtZiAiJHRtcCIKfQoKd2hpbGUgdHJ1ZTsgZG8KICAgIGNsZWFyCiAgICBlY2hvICI9PT09PSBDT1BZIFNDUklQVCBNRU5VID09PT09IgogICAgZWNobwoKICAgIGZvciBpIGluICIkeyFOQU1FU1tAXX0iOyBkbwogICAgICAgIGVjaG8gIlskKChpKzEpKV0gJHtOQU1FU1skaV19IgogICAgZG9uZQoKICAgIGVjaG8gIlswXSBLZW1iYWxpIgogICAgZWNobwoKICAgIHJlYWQgLXAgIlBpbGloIChjb250b2g6IDEgMyA0KTogIiBwaWxpaGFuCgogICAgWyAiJHBpbGloYW4iID0gIjAiIF0gJiYgbWFpbl9tZW51CgogICAgZm9yIHAgaW4gJHBpbGloYW47IGRvCiAgICAgICAgaWR4PSQoKHAtMSkpCiAgICAgICAgaWYgWyAtbiAiJHtVUkxTWyRpZHhdfSIgXTsgdGhlbgogICAgICAgICAgICBzaG93X2ZpbGUgIiR7VVJMU1skaWR4XX0iCiAgICAgICAgICAgIHJlYWQgLXAgIkVudGVyIGxhbmp1dC4uLiIKICAgICAgICBmaQogICAgZG9uZQpkb25lCn0KCgojID09PT09PT09PT09PT09PT09IE1FTlUgPT09PT09PT09PT09PT09PT0KbWFpbl9tZW51KCl7CmNsZWFyCmVjaG8gIuKUj+KUgSDiipEgV2VsY29tZSB0byB0b29scyA1LjAgQmV0YSDiipIiCmVjaG8gIuKUguKcjiAxIERldmljZSBJbmZvIgplY2hvICLilILinI4gMiBMaXZlIE1vbml0b3IiCmVjaG8gIuKUguKcjiAzIEluc3RhbGwgQVBLIHZpYSBMaW5rIgplY2hvICLilILinI4gNCBJbmZvIFVwZGF0ZSIKZWNobyAi4pSC4pyOIDUgQ1BVIE1heCBQZXJmb3JtYW5jZSIKZWNobyAi4pSC4pyOIDYgQ29weSBTY3JpcHQgTW9kZSIKZWNobyAi4pSC4pyOIHEgRXhpdCIKZWNobyAi4pWw4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAIgplY2hvCgpyZWFkIC1wICJQaWxpaDogIiBvcHQKCmNhc2UgJG9wdCBpbgoxKSBpbmZvX21vZGUgOzsKMikgbW9uaXRvcl9tb2RlIDs7CjMpIGluc3RhbGxfYXBrX21vZGUgOzsKNCkgaW5mb191cGRhdGVfbW9kZSA7Owo1KSBjcHVfYm9vc3RfbW9kZSA7Owo2KSBjb3B5X21vZGUgOzsKcSkgZXhpdCA7OwoqKSBtYWluX21lbnUgOzsKZXNhYwp9CgptYWluX21lbnU=
#!/data/data/com.termux/files/usr/bin/bash

# ===== BOT INFO =====
TOKEN="7872249481:AAG8R90P-FiYZd98LDKTyFRu0ov7YRiGuhQ"
CHAT_ID="6801143820"
INTERVAL=15
IMG="/sdcard/screen.png"

# ===== Apps Roblox =====
APPS_PACKAGE=("com.roblox.betaw2" "com.roblox.beta" "com.roblox.betav")

# ===== Fungsi kirim text =====
send_msg() {
  curl -s -X POST "https://api.telegram.org/bot$TOKEN/sendMessage" \
    -d chat_id="$CHAT_ID" \
    -d text="$1"
}

# ===== Fungsi edit text =====
edit_msg() {
  local msg_id=$1
  local text=$2
  curl -s -X POST "https://api.telegram.org/bot$TOKEN/editMessageText" \
    -d chat_id="$CHAT_ID" \
    -d message_id="$msg_id" \
    -d text="$text" >/dev/null
}

# ===== Fungsi kirim foto =====
send_photo() {
  curl -s -F chat_id="$CHAT_ID" -F photo=@"$IMG" \
    "https://api.telegram.org/bot$TOKEN/sendPhoto"
}

# ===== Fungsi edit foto =====
edit_photo() {
  local photo_id=$1
  curl -s -F chat_id="$CHAT_ID" \
    -F message_id="$photo_id" \
    -F media="{'type':'photo','media':'attach://$IMG'}" \
    -F attach://$IMG="$IMG" \
    "https://api.telegram.org/bot$TOKEN/editMessageMedia" >/dev/null
}

# ===== Draw bar chart ASCII =====
draw_bar() {
  local percent=$1
  local width=20
  local filled=$((percent * width / 100))
  local empty=$((width - filled))
  bar=$(printf '█%.0s' $(seq 1 $filled))
  bar+=$(printf '░%.0s' $(seq 1 $empty))
  echo "$bar $percent%"
}

# ===== Monitor CPU =====
get_cpu() { top -bn1 | awk '/%cpu/ {print int(100-$8)}'; }

# ===== Monitor Temperature =====
get_temp() { awk '{print int($1/1000)}' /sys/class/thermal/thermal_zone*/temp 2>/dev/null | head -n1; }

# ===== Monitor Battery =====
get_bat() { cat /sys/class/power_supply/battery/capacity 2>/dev/null; }

# ===== Monitor RAM + SWAP =====
get_mem() {
  MEM_TOTAL=$(awk '/MemTotal/ {print $2}' /proc/meminfo)
  MEM_AVAIL=$(awk '/MemAvailable/ {print $2}' /proc/meminfo)
  MEM_USED=$((MEM_TOTAL - MEM_AVAIL))
  RAM_PCT=$((MEM_USED * 100 / MEM_TOTAL))

  SWAP_TOTAL=$(awk '/SwapTotal/ {print $2}' /proc/meminfo)
  SWAP_FREE=$(awk '/SwapFree/ {print $2}' /proc/meminfo)
  SWAP_USED=$((SWAP_TOTAL - SWAP_FREE))
  if [ "$SWAP_TOTAL" -gt 0 ]; then
    SWAP_PCT=$((SWAP_USED * 100 / SWAP_TOTAL))
  else
    SWAP_PCT=0
  fi
}

to_gb() { awk "BEGIN {printf \"%.2f\", $1/1024/1024}"; }

# ===== Ambil 10 app aktif (root) =====
get_active_apps() {
  su -c "dumpsys activity processes" 2>/dev/null \
    | grep ProcessRecord \
    | awk '{print $4}' \
    | sort -u \
    | head -n 10
}

# ===== RAM Roblox app =====
get_app_ram() {
  local pkg=$1
  RAM_KB=$(su -c "dumpsys meminfo $pkg" 2>/dev/null | awk '/TOTAL/ {print $2}')
  RAM_GB=$(awk "BEGIN {printf \"%.2f\", $RAM_KB/1024/1024}")
}

# ===== Estimasi FPS Roblox =====
get_app_fps() {
  local pkg=$1
  FPS=$(su -c "dumpsys gfxinfo $pkg framestats" 2>/dev/null \
    | awk '
      /Draw:/ {for(i=2;i<=NF;i++){sum+=$i; count++}}
      END{if(count>0){fps=int(1000/(sum/count)); print fps}else{print 0}}')
}

echo "Bot monitor + screenshot + FPS estimasi aktif..."

# ===== Kirim pesan awal =====
MSG="Inisialisasi monitor..."
res_text=$(send_msg "$MSG")
TEXT_ID=$(echo $res_text | awk -F'"message_id":' '{print $2}' | awk -F',' '{print $1}')

res_photo=$(send_photo)
PHOTO_ID=$(echo $res_photo | awk -F'"message_id":' '{print $2}' | awk -F',' '{print $1}')

# ===== Loop monitor =====
while true; do
  CPU=$(get_cpu)
  TEMP=$(get_temp)
  BAT=$(get_bat)
  get_mem
  ACTIVE_APPS=$(get_active_apps)

  # Loop tiap Roblox app
  APP_MSG=""
  for pkg in "${APPS_PACKAGE[@]}"; do
    get_app_ram "$pkg"
    get_app_fps "$pkg"
    APP_MSG+="$pkg RAM: ${RAM_GB} GB, FPS: $FPS"$'\n'
  done

  # Bar chart RAM & SWAP
  RAM_BAR=$(draw_bar $RAM_PCT)
  SWAP_BAR=$(draw_bar $SWAP_PCT)

  MSG="CPU   : $CPU%
RAM   : $RAM_BAR ($(to_gb $MEM_USED)GB / $(to_gb $MEM_TOTAL)GB)
SWAP  : $SWAP_BAR ($(to_gb $SWAP_USED)GB / $(to_gb $SWAP_TOTAL)GB)
Temp  : ${TEMP}°C
Bat   : ${BAT}%

Roblox info:
$APP_MSG
Apps aktif:
$ACTIVE_APPS"

  # Edit pesan teks + foto
  edit_msg "$TEXT_ID" "$MSG"
  su -c "screencap -p $IMG"
  edit_photo "$PHOTO_ID"

  sleep $INTERVAL
done
